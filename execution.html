<html class="notion-html"><head lang="en"><meta charset="utf-8"/><meta content="width=device-width,height=device-height,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" name="viewport"/><title>Execution</title><meta content="en_US" property="og:locale"/><link href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAB29JREFUWEfFVmtsFOcVPTM7OzuPfXoXPzCGBQKCbSkm4KSFlqZx8gPUplQNCVLT9keoStO0pK1ETEsVlJIGGkVVDWlTkiiPKoFELQ19uAoCKxAoiLI0foBtzCvGXoO9tne9szszOzPfVN+s1zHYJnb+dKTRjkZ37jn33HPvtwz+zxfzafFjsdgy0zS3EEJcHMftam9vj3+aXNMmEIvFyk3T/BEh5PumaYZt2wbLsoNut/tFjuN2nz9//vp0iEyLQHV19bdUVa0zDOOzlmWBghcvhmHgcrlaJUna0dra+vZUSUyJwIoVK1bpuv6EpmkPmqbpABfvW4FcLhcl8hbDMM91dnZ++ElEbkugpqamXFXVraZpPmqapkwIuQl4rAITqJGUZbk+EAjsOX78+NBkRCYjwKxatWq9oig/13V9KZW7CE4TOWBUheLzbcqUJOl0IBB45tSpU3+bKGwcgdra2ppMJrM1m81+wzCNApCDdzMosSyAYUB7T8nRX+caITZKFADHcZYgCK9FIpFdx44d6xxLZJRAbW1tWFXVJ1RV/aGu6yGadGyS0b7Dhm3ZECURsiw74FlFQU5VnXiasGjNYluK3wqCcC0UCu22LOuFeDyec+JjsRhfUVHxQCaTqdM0bTkh1N3FYgoPo4azbSiqAbh4RGeVgrEt5HIqVE2DqqoOGZZlRwsca1b6XFRKEITGYDC4M5lMfsBEo9ENkUh4n2UR0F6PrZrWUiBjQ88TZFQbi6p4LK4AmhMydOKCxAN6Po/u7h4qNTiXq5DDIU5gExtkzNTQKbIsE5Isg2XY9QzP84ui0Wj9jEj4fhsMdF0DIYUxo2ksy0Y6RxD08XjwCwJWLzDx33MDaLnuQXeKwaXreRiG7ijg9/kcBag9i74pmJc4OU3DAOfmEAgEYJrWS6lU6teOB8rKyuSSUOhXkUjkJzzvdmSlLBWNwCAsapcK+OadFozcMC4kTESCPEhew95DKcSv5CF4XA44z/PUl44RyYhxKbhlWqCV+/1++Py+rGWRrfF4fHfRM6M9W7hw4WMzIpGdPp/X1zekoTzE4jtfJJgjpdHRrcEAh6AEnOlU8a9mYDjPgeecYQDDsB8bkFZMZSc2DNMEyzAoLS2FJEkX+5PJzS0tLQ2jG/TW2SwpmXu/NxD+3drVZYs33p3CQP8g+hQWXpHF5V4VB89YuJqW4Pfy8HAFg1J5C4BkRH4bxCIwjDwEUcSsykoYptXY39//WHNzc8eEYzj25aZHY3c9soRvyA4qYdsjIZnScfCMiQ8TEkRRhOTBTT4pyE0NV+g17btpmQiHw07lyeTAH7u6uuquXr2aurXgCTehffW+Zd1H+/7SO6CVn2jV+P3NZa48I8In0M8pSPGmZqMm+3hUKTB9UVFRAa/Xh/NtbbvOnTtXN61VbB+/60vIyYfebrj2+23vYt6s6Jx1oaCMbDbn9LQ4047Di2Rs6nITHg+PyspK6Hoe8XgcPYnEVwH8c1oEzMZ1DyV7P3r12deVNXE1+oPccO8Gn8+LSGk5NC1fGNWRnhNqOIs4Lvf5fJgxoxQ3+vrQ1NSE4eFhuqK3apq2c8oE7O3bWdx7+r0rp/9T+8ZR4bXD6TuWpVKD1Wp6EDMiYcysmgOLkJHNZ8Oim5MQlIRCEGUZly9fQU9PDzRNRT5v0Lgf67rujNxE1zgP2NvBtpZ97u9cdnjtW2f5Pf+4EFqpDKfu1DXVmf2SYABz5t8Bzs0jl3PWuWM207TQ1t6OXDbnnBPZbBbpdLpvcHBwJYBLUyZAA2u//JnnN333Kz99+c/n1l3rGp6dU5L1Rj7vzLllGvDKEqJz50H2+yGJItLpDC50doJlGfj9AfqHxJG/q6vrl4qi7JgMfNwiKgbu+N6S3ctrlj6+f9+Jhz+yrxzovBT9QM8Nf553c3BxnGM2+lw1ezZssOhJ9ECSZISCQQiC4GymRCJxsq2tbQ2A9LQI2O/ApepLDl28NHDvv5v7X9l0wNhYXV29oKur+023i9S43R4HgI4eywCsi4PslREMBOH1+SB4PHRSWpqamh5KJBLttwOfUIHDdaXzqmPlp5PXhsLtCfXGgbPZ5W+cVHtKZs6sspTMi7IkrWVYFvSmJ5/HI0D2ep3qJUnC0NDQYd7j2dTY2Dhp32+7CY2X565OewLv9yVSTFoF9p0cWFf/XuZg4aMyORTQnhJE4Wcc52ZprwVRcE43wSNoSjbzW0XJPdvR0ZH5pMonPQvshvlrBgb9DcneIRgMj4MXlM3b9ibqxyYMhfwbPB5xhyiI8928GxznPpHPq09fvHjl0FSBJyVw4s27v76I6O8O3BiCyYn4azy97Rd/6n3m1sSBQGC+KIqbbNu+ZlnWq8lkcspV37YFT66s2vDk46X7ktcHYMCDs+3qc9/e27VlupVNNX7cInpnfdXD9zxQun+ofxC8i8cfjmZf+c2B7o1TTTjduHEEjmyeu3rhYt/RXDYLogN7jqSffuFI8qnpJp5q/DgCX5sJacvayCO2l1ugJNT+599Pv36kDzemmnC6cf8DZNMn5Io3zmcAAAAASUVORK5CYII=" rel="shortcut icon" type="image/x-icon"/><link href="/images/logo-ios.png" rel="apple-touch-icon"/><meta content="yes" name="apple-mobile-web-app-capable"/><meta content="telephone=no" name="format-detection"/><meta content="no" name="msapplication-tap-highlight"/><link href="assets/css/e218a1aef6df86309cb95b61e446888efa3b0379.css" media="print" rel="stylesheet"/><link href="assets/css/019e696da19f5dba12f9b7fffaa163689299d4c7.css" rel="stylesheet"/><link href="assets/css/bdf63106d407e81b19ae644945d64ca431d390fd.css" rel="stylesheet" type="text/css"/><meta content="Edouard d'Archimbaud" name="title"/><meta content="Edouard d'Archimbaud official website" name="description"/><link href="assets/css/e1d809d762eeca23edf0cb31bb17bf3c703085f5.css" rel="stylesheet"/><style type="text/css"></style></head><body class="notion-body"><style>body{background:#fff}body.dark{background:#191919}@keyframes startup-shimmer-animation{0%{transform:translateX(-100%) translateZ(0)}100%{transform:translateX(100%) translateZ(0)}}@keyframes startup-shimmer-fade-in{0%{opacity:0}100%{opacity:1}}@keyframes startup-spinner-rotate{0%{transform:rotate(0) translateZ(0)}100%{transform:rotate(360deg) translateZ(0)}}#initial-loading-spinner{position:fixed;height:100vh;width:100vw;z-index:-1;display:none;align-items:center;justify-content:center;opacity:.5}#initial-loading-spinner svg{height:24px;width:24px;animation:startup-spinner-rotate 1s linear infinite;transform-origin:center center;pointer-events:none}#skeleton{background:#fff;position:fixed;height:100vh;width:100vw;z-index:-1;display:none;overflow:hidden}#initial-loading-spinner.show,#skeleton.show{display:flex}body.dark #skeleton{background:#191919}.notion-front-page #skeleton,.notion-mobile #skeleton{display:none}#skeleton-sidebar{background-color:#fbfbfa;box-shadow:inset -1px 0 0 0 rgba(0,0,0,.025);display:flex;width:240px;flex-direction:column;padding:12px 14px;overflow:hidden}body.dark #skeleton-sidebar{background-color:#202020;box-shadow:inset -1px 0 0 0 rgba(255,255,255,.05)}#skeleton.isElectron #skeleton-sidebar{padding-top:46px}#skeleton .row{display:flex;margin-bottom:8px;align-items:center}#skeleton .row.fadein{animation:1s ease-in 0s 1 normal both running startup-shimmer-fade-in}#skeleton .chevron{width:12px;height:12px;display:block;margin-right:4px;fill:rgba(227,226,224,.5)}body.dark #skeleton .chevron{fill:#2f2f2f}.startup-shimmer{background:rgba(227,226,224,.5);overflow:hidden;position:relative}body.dark .startup-shimmer{background:#2f2f2f}.startup-shimmer::before{content:"";position:absolute;height:100%;width:100%;z-index:1;animation:1s linear infinite startup-shimmer-animation;background:linear-gradient(90deg,transparent 0,rgba(255,255,255,.4) 50%,transparent 100%)}body.dark .startup-shimmer::before{background:linear-gradient(90deg,transparent 0,rgba(86,86,86,.4) 50%,transparent 100%)}#skeleton .icon{width:20px;height:20px;border-radius:4px}#skeleton .text{height:10px;border-radius:10px}#skeleton .draggable{-webkit-app-region:drag;position:absolute;top:0;left:0;width:100%;height:36px;display:none}#skeleton.isElectron .draggable{display:block}</style><style id="scroll-properties"></style><div id="notion-app"><div class="notion-app-inner notion-light-theme" style='color: rgb(55, 53, 47); fill: currentcolor; line-height: 1.5; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; -webkit-font-smoothing: auto; background-color: white;'><div style="height: 100%;"><div class="notion-cursor-listener" style="width: 100vw; height: 100%; position: relative; display: flex; flex: 1 1 0%; background: white; cursor: text;"><div class="" style="display: flex; flex-direction: column; width: 100%; overflow: hidden;"><div style="max-width: 100vw; z-index: 100; background: white; user-select: none;"><div class="notion-topbar" style="width: 100%; max-width: 100vw; height: 45px; opacity: 1; transition: opacity 700ms ease 0s, color 700ms ease 0s; position: relative;"><div style="display: flex; justify-content: space-between; align-items: center; overflow: hidden; height: 45px; padding-left: 12px; padding-right: 10px;"><div class="notranslate" style="display: flex; align-items: center; line-height: 1.2; font-size: 14px; height: 100%; flex-grow: 0; margin-right: 8px; min-width: 0px;"><div class="notion-selectable notion-page-block" data-block-id="d8397a78-1321-456c-9c10-1feea7a42b60" style="display: flex; align-items: center; min-width: 0px;"><a href="edouard-d-archimbaud-build-in-public-log.html" rel="noopener noreferrer" style="display: flex; text-decoration: none; user-select: none; cursor: pointer; color: inherit; min-width: 0px;"><div role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 1; white-space: nowrap; height: 24px; border-radius: 4px; font-size: inherit; line-height: 1.2; min-width: 0px; padding: 2px; color: rgb(55, 53, 47);" tabindex="0"><div style="display: flex; align-items: center; min-width: 0px;"><div class="notion-record-icon notranslate" style="display: flex; align-items: center; justify-content: center; height: 20px; width: 20px; border-radius: 0.25em; flex-shrink: 0; margin-right: 6px; font-weight: 500;"><div style="display: flex; align-items: center; justify-content: center; height: 20px; width: 20px;"><div style="height: 18px; width: 18px; font-size: 18px; line-height: 1; margin-left: 0px; color: black;"><span aria-label="üë®‚Äçüíª" role="img" style='font-family: "Apple Color Emoji", "Segoe UI Emoji", NotoColorEmoji, "Noto Color Emoji", "Segoe UI Symbol", "Android Emoji", EmojiSymbols; line-height: 1em; white-space: nowrap;'>üë®‚Äçüíª</span></div></div></div><span class="notranslate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 160px;">Edouard d‚ÄôArchimbaud | Build in Public Log</span></div></div></a></div><span style="margin-left: 2px; margin-right: 2px; color: rgba(55, 53, 47, 0.5);">/</span><div class="notion-selectable notion-page-block" data-block-id="47f5b952-291c-48f5-88d6-6e129bba26a0" style="display: flex; align-items: center; min-width: 0px;"><a href="become-a-quant-trader.html" rel="noopener noreferrer" style="display: flex; text-decoration: none; user-select: none; cursor: pointer; color: inherit; min-width: 0px;"><div role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 1; white-space: nowrap; height: 24px; border-radius: 4px; font-size: inherit; line-height: 1.2; min-width: 0px; padding: 2px; color: rgb(55, 53, 47);" tabindex="0"><div style="display: flex; align-items: center; min-width: 0px;"><div class="notion-record-icon notranslate" style="display: flex; align-items: center; justify-content: center; height: 20px; width: 20px; border-radius: 0.25em; flex-shrink: 0; margin-right: 6px; font-weight: 500;"><div style="display: flex; align-items: center; justify-content: center; height: 20px; width: 20px;"><div style="height: 18px; width: 18px; font-size: 18px; line-height: 1; margin-left: 0px; color: black;"><span aria-label="üíπ" role="img" style='font-family: "Apple Color Emoji", "Segoe UI Emoji", NotoColorEmoji, "Noto Color Emoji", "Segoe UI Symbol", "Android Emoji", EmojiSymbols; line-height: 1em; white-space: nowrap;'>üíπ</span></div></div></div><div class="notranslate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 160px;">Become a Quant Trader</div></div></div></a></div><span style="margin-left: 2px; margin-right: 2px; color: rgba(55, 53, 47, 0.5);">/</span><div role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 1; white-space: nowrap; height: 24px; border-radius: 4px; font-size: 14px; line-height: 1.2; min-width: 0px; padding-left: 6px; padding-right: 6px; color: rgb(55, 53, 47);" tabindex="0"><div class="notion-record-icon notranslate" style="display: flex; align-items: center; justify-content: center; height: 20px; width: 20px; border-radius: 0.25em; flex-shrink: 0; margin-right: 6px;"><div style="display: flex; align-items: center; justify-content: center; height: 20px; width: 20px;"><div style="height: 18px; width: 18px; font-size: 18px; line-height: 1; margin-left: 0px; color: black;"><span aria-label="üéì" role="img" style='font-family: "Apple Color Emoji", "Segoe UI Emoji", NotoColorEmoji, "Noto Color Emoji", "Segoe UI Symbol", "Android Emoji", EmojiSymbols; line-height: 1em; white-space: nowrap;'>üéì</span></div></div></div><div class="notranslate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 240px;">Execution</div></div></div><div style="flex-grow: 1; flex-shrink: 1;"></div><div role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 0; white-space: nowrap; height: 28px; border-radius: 4px; font-size: 14px; line-height: 1.2; min-width: 0px; padding-left: 8px; padding-right: 8px; color: rgb(55, 53, 47);" tabindex="0"><svg class="searchNew" style="width: 14px; height: 14px; display: block; fill: inherit; flex-shrink: 0; backface-visibility: hidden; margin-right: 6px;" viewBox="0 0 17 17"><path d="M6.78027 13.6729C8.24805 13.6729 9.60156 13.1982 10.709 12.4072L14.875 16.5732C15.0684 16.7666 15.3232 16.8633 15.5957 16.8633C16.167 16.8633 16.5713 16.4238 16.5713 15.8613C16.5713 15.5977 16.4834 15.3516 16.29 15.1582L12.1504 11.0098C13.0205 9.86719 13.5391 8.45215 13.5391 6.91406C13.5391 3.19629 10.498 0.155273 6.78027 0.155273C3.0625 0.155273 0.0214844 3.19629 0.0214844 6.91406C0.0214844 10.6318 3.0625 13.6729 6.78027 13.6729ZM6.78027 12.2139C3.87988 12.2139 1.48047 9.81445 1.48047 6.91406C1.48047 4.01367 3.87988 1.61426 6.78027 1.61426C9.68066 1.61426 12.0801 4.01367 12.0801 6.91406C12.0801 9.81445 9.68066 12.2139 6.78027 12.2139Z"></path></svg>Search</div><div role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 0; white-space: nowrap; height: 28px; border-radius: 4px; font-size: 14px; line-height: 1.2; min-width: 0px; padding-left: 8px; padding-right: 8px; color: rgb(55, 53, 47);" tabindex="0">Duplicate</div><div role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: flex; align-items: center; justify-content: center; width: 32px; height: 28px; border-radius: 3px;" tabindex="0"><svg class="dots" style="width: 18px; height: 18px; display: block; fill: inherit; flex-shrink: 0; backface-visibility: hidden;" viewBox="0 0 13 3"><g><path d="M3,1.5A1.5,1.5,0,1,1,1.5,0,1.5,1.5,0,0,1,3,1.5Z"></path><path d="M8,1.5A1.5,1.5,0,1,1,6.5,0,1.5,1.5,0,0,1,8,1.5Z"></path><path d="M13,1.5A1.5,1.5,0,1,1,11.5,0,1.5,1.5,0,0,1,13,1.5Z"></path></g></svg></div><div style="flex: 0 0 auto; width: 1px; height: 16px; margin-left: 8px; margin-right: 8px; background: rgba(55, 53, 47, 0.16);"></div><div role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 0; white-space: nowrap; height: 28px; border-radius: 4px; font-size: 14px; line-height: 1.2; min-width: 0px; padding-left: 8px; padding-right: 8px; color: rgb(55, 53, 47);" tabindex="0"><svg class="notionLogo" style="width: 18px; height: 18px; display: block; fill: inherit; flex-shrink: 0; backface-visibility: hidden; margin-right: 6px;" viewBox="0 0 120 126"><path d="M 20.6927 21.9315C 24.5836 25.0924 26.0432 24.8512 33.3492 24.3638L 102.228 20.2279C 103.689 20.2279 102.474 18.7705 101.987 18.5283L 90.5477 10.2586C 88.3558 8.55699 85.4356 6.60818 79.8387 7.09563L 13.1433 11.9602C 10.711 12.2014 10.2251 13.4175 11.1939 14.3924L 20.6927 21.9315ZM 24.8281 37.9835L 24.8281 110.456C 24.8281 114.351 26.7745 115.808 31.1553 115.567L 106.853 111.187C 111.236 110.946 111.724 108.267 111.724 105.103L 111.724 33.1169C 111.724 29.958 110.509 28.2544 107.826 28.4976L 28.721 33.1169C 25.8018 33.3622 24.8281 34.8225 24.8281 37.9835ZM 99.5567 41.8711C 100.042 44.0622 99.5567 46.2512 97.3618 46.4974L 93.7143 47.2241L 93.7143 100.728C 90.5477 102.43 87.6275 103.403 85.1942 103.403C 81.2983 103.403 80.3226 102.186 77.4044 98.54L 53.5471 61.087L 53.5471 97.3239L 61.0964 99.0275C 61.0964 99.0275 61.0964 103.403 55.0057 103.403L 38.2148 104.377C 37.727 103.403 38.2148 100.973 39.9179 100.486L 44.2996 99.2717L 44.2996 51.36L 38.2158 50.8725C 37.728 48.6815 38.9431 45.5225 42.3532 45.2773L 60.3661 44.0631L 85.1942 82.0036L 85.1942 48.4402L 78.864 47.7136C 78.3781 45.0351 80.3226 43.0902 82.7569 42.849L 99.5567 41.8711ZM 7.5434 5.39404L 76.9175 0.285276C 85.4366 -0.445402 87.6285 0.0440428 92.983 3.93368L 115.128 19.4982C 118.782 22.1747 120 22.9034 120 25.8211L 120 111.187C 120 116.537 118.051 119.701 111.237 120.185L 30.6734 125.05C 25.5584 125.294 23.124 124.565 20.4453 121.158L 4.13735 99.9994C 1.21516 96.1048 0 93.191 0 89.7819L 0 13.903C 0 9.5279 1.94945 5.8785 7.5434 5.39404Z"></path></svg>Try Notion</div></div></div><div style="width: calc(100% - 0px); user-select: none;"></div></div><div class="notion-frame" style="flex-grow: 0; flex-shrink: 1; display: flex; flex-direction: column; background: white; z-index: 1; height: calc(100vh - 45px); max-height: 100%; position: relative; width: 1920px;"><div class="notion-scroller vertical" style="display: flex; flex-direction: column; z-index: 1; flex-grow: 1; position: relative; align-items: center; margin-right: 0px; margin-bottom: 0px; overflow: hidden auto;"><div style="position: absolute; top: 0px; left: 0px;"><div></div></div><div class="whenContentEditable" data-content-editable-root="true" style="caret-color: rgb(55, 53, 47); width: 100%; display: flex; flex-direction: column; position: relative; align-items: center; flex-grow: 1; --whenContentEditable--WebkitUserModify:read-write-plaintext-only;"><span style="height: 1px; width: 1px;"></span><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" style="user-select: none; --pseudoSelection--background:transparent; width: 100%; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; flex-grow: 0; z-index: 2;"></div><div style="width: 100%; display: flex; justify-content: center; z-index: 3; flex-shrink: 0;"><div style="max-width: 100%; min-width: 0px; width: 900px;"><div style="width: 100%; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; flex-grow: 0;"><div style="max-width: 100%; padding-left: calc(96px + env(safe-area-inset-left)); width: 100%;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" style="user-select: none; --pseudoSelection--background:transparent; pointer-events: none;"><div class="notion-record-icon notranslate" style="display: flex; align-items: center; justify-content: center; height: 78px; width: 78px; border-radius: 0.25em; flex-shrink: 0; position: relative; z-index: 1; margin-left: 3px; margin-bottom: 0px; margin-top: 96px; pointer-events: auto;"><div style="display: flex; align-items: center; justify-content: center; height: 78px; width: 78px;"><div style="height: 78px; width: 78px; font-size: 78px; line-height: 1; margin-left: 0px; color: black;"><span aria-label="üéì" role="img" style='font-family: "Apple Color Emoji", "Segoe UI Emoji", NotoColorEmoji, "Noto Color Emoji", "Segoe UI Symbol", "Android Emoji", EmojiSymbols; line-height: 1em; white-space: nowrap;'>üéì</span></div></div></div><div class="notion-page-controls" style='display: flex; justify-content: flex-start; flex-wrap: wrap; margin-top: 8px; margin-bottom: 4px; margin-left: -1px; color: rgba(55, 53, 47, 0.5); font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; height: 24px; pointer-events: auto;'></div></div><div style="padding-right: calc(96px + env(safe-area-inset-right));"><div><div class="notion-selectable notion-page-block" data-block-id="8e010f87-bc8b-437c-9297-13ee9135d256" style='color: rgb(55, 53, 47); font-weight: 700; line-height: 1.2; font-size: 40px; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; cursor: text; display: flex; align-items: center;'><div contenteditable="false" data-content-editable-leaf="true" placeholder="Untitled" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Execution</div></div><div style="margin-left: 4px;"></div></div></div></div></div><div style="width: 100%; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; flex-grow: 0;"><div contenteditable="false" data-content-editable-void="true" style="padding-left: calc(96px + env(safe-area-inset-left)); padding-right: calc(96px + env(safe-area-inset-right)); max-width: 100%; width: 100%;"></div></div></div></div><main style="display: flex; width: 100%; justify-content: center; padding-top: 5px;"><div style="max-width: 100%; min-width: 0px; width: 900px;"><div class="notion-page-content" style="flex-shrink: 0; flex-grow: 1; max-width: 100%; display: flex; align-items: flex-start; flex-direction: column; font-size: 16px; line-height: 1.5; width: 100%; z-index: 4; padding-bottom: 30vh; padding-left: calc(96px + env(safe-area-inset-left)); padding-right: calc(96px + env(safe-area-inset-right));"><div class="notion-selectable notion-quote-block" data-block-id="e598b711-2c7f-46ca-9b70-e55f84052a44" style="width: 100%; max-width: 1728px; margin-top: 4px; margin-bottom: 4px;"><div style="font-size: 1em; padding: 3px 2px; color: inherit; fill: inherit; display: flex;"><div style="border-left: 3px solid currentcolor; padding-left: 14px; padding-right: 14px; width: 100%;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Empty quote" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding-left: 2px; padding-right: 2px;">I hope to break even this week. I need the money. ‚Äìveteran gambler</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="06412eb1-a41a-4c94-8ed1-3467dc3d5be7" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; min-height: 1em; color: rgb(55, 53, 47); -webkit-text-fill-color: rgba(55, 53, 47, 0.5);"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="334aef54-2bbf-4690-9c2b-2aa434f8b9a5" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Everyone has to model slippage on their own based on historical execution data since it depends on account size, instruments traded, what time of each day you trade, etc so there‚Äôs no good general model. Slippage is important because it can make alpha-generating strategies lose money. Modelling slippage is important because then you can optimize trade size and frequency to minimize transaction costs. We want everything to be measured as accurately as possible so optimization can be automated.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="42e2ecda-ca4c-4824-8fc2-4b0ba750c7e3" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">This section is naturally organized under the development of a few definitions.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="fa6ee814-4f1d-4d36-a21f-eb60de4f73f6" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span class="notion-enable-hover" data-token-index="0" style="font-weight:600">Participation Rate</span> = Percent of ADV.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="9f30192f-f331-4ece-9323-433f075579d9" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">If you transact 100,000 shares of GOOG in one day which trades an average of 3.0M shares per day, then your participation rate is 100, 000/3, 000, 000 = 3.0%.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="7e08e141-7fb2-429d-bf26-0d346e271fb8" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Actually we can generalize percent of ADV to be over a time range other than a day. Participation rate is actually the percentage of volume your trading accounts for out of the average total volume that transacts in the stock over a given range of time. So if 500,000 shares of GOOG are traded every hour, and you buy up a 100,000 position over the course of an hour, then your participation rate is 20%. Higher participation rates increase slippage and vice-versa. 1% could be considered a high participation rate (for GOOG this would be 3M ‚àó 500 ‚àó 0.01 = $15M) although I‚Äôm just trying to give you a rough feel for how low a high participation can
be.</div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="262d371d-dceb-431e-8023-bf899339d995" style="width: 100%; max-width: 1728px; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style='max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; font-weight: 600; font-size: 1.875em; line-height: 1.3;'>Liquidity Impact</div></div></div><div class="notion-selectable notion-text-block" data-block-id="f5ea6eba-888c-4aa5-a8b8-3f0622c74a5e" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Liquidity impact is the money you lose when there aren‚Äôt enough sellers so you have to bid more to access more supply of shares (i.e. buyers). The two key determinants here are Spread and Depth. Here‚Äôs what they look like in terms of an order book:</div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="5dd6b55c-ebf4-4dc9-8c83-bbc0268ca4cc" style="width: 100%; max-width: 1920px; align-self: center; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="height: 100%; width: 100%;"><img referrerpolicy="same-origin" src="assets/images/0d06e02a8841a277fe652f588d16131e03bf043e.png" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="ff95d9b9-a5e9-4143-b4e3-4581c9f112da" style="width: 100%; max-width: 1728px; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style='max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; font-weight: 600; font-size: 1.875em; line-height: 1.3;'>Slicing Up Orders</div></div></div><div class="notion-selectable notion-text-block" data-block-id="26ef307b-032f-4bcd-972f-4a7ad6029577" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Spread hits you with costs every time you trade, low depth eats into big orders. Higher participation rates gen- erally cause higher liquidity impact. There are some simple but widely used strategies to decrease participation rate and reduce liquidity impact. Basically you slice your order up over time. There are two simple patterns of slicing:</div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="d5c8b953-044d-42ad-abb2-efb20576d53a" style="width: 100%; max-width: 1920px; align-self: center; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="height: 100%; width: 100%;"><img referrerpolicy="same-origin" src="assets/images/e547af50748d18b6862be92ca672578346a876b8.png" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="f1019de7-0c21-4d21-925e-90ff2065561f" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">VWAP is better than TWAP. There are other execution strategies with creative names, like guerilla, sonar, etc which actually interact with the market during the day. Instead of trying to target liquidity based on historical average volumes, they ping the market to look for ‚Äúicebergs‚Äù - large hidden orders, which the algo can extract liquidity from without any impact, until the iceberg is exhausted. These more sophisticated execution algorithms are generally classified as liquidity seeking, rather than passive.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="1c96d3a9-362f-4a42-894a-d6698bcc63e8" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">In the news you‚Äôd hear that spreads are widening because of high volatility. We‚Äôve covered how participation rate causes liquidity impact when the market depth is too shallow; now I‚Äôll explain briefly here how the market making business works to show why spreads widen and complete this part of the cost picture. A market maker is like a warehouse. That‚Äôs their business model, warehousing inventory (sounds kind of boring huh?). Instead of selling to other traders, you sell to the market maker and then he sits around and waits for a buyer so you don‚Äôt have to. He‚Äôs worried that the price will go down before he finds another buyer so he charges you a spread.
Now of course there are a bunch of market makers so just one can‚Äôt set the spread, but competition drives them to more or less agree.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="e658134d-a262-4db4-a4d1-e45f1e0f0f1c" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">When volatility is high, the price has a tendency to move faster so the market makers charge higher spreads to hold the inventory until someone else comes. They are taking more of a risk. Market making is one of the most profitable trading strategies since some exchanges will actually give rebates (the opposite of commissions) for ‚Äúliquidity providers‚Äù, i.e. traders who use limit orders, like market makers do.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="04593ee0-45ca-4121-859d-525dc648b541" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Now let‚Äôs look at the other component of slippage.</div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="26de32a9-775a-42db-a281-f28ca8342d4d" style="width: 100%; max-width: 1728px; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style='max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; font-weight: 600; font-size: 1.875em; line-height: 1.3;'>Alpha Loss</div></div></div><div class="notion-selectable notion-text-block" data-block-id="b81230a8-a44d-4574-8a25-3f01a15c460d" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">You only attempt to trade into a position that is going to make money, so the longer you take to get in, the more of that profit has already been absorbed and you missed. Whereas we wanted to slow down execution to decrease liquidity impact, here we want to execute as fast as possible. This suggests an optimization problem. We‚Äôll return to that in a second.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="3bc12e2b-2b7f-4c21-b581-03ff6f1bea6b" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Estimate short term alpha by asking the portfolio manager or trader where he expects the market to go over the next few hours after a buy/sell order is issued on average, or by statistically analysing a large sample of past executions and the path of prices before and after on average. Anytime we say statistical analysis we generally mean dealing with averages or frequencies instead of looking for trends or meaning in individual points.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="6ba92b04-eefb-4539-a2f8-1a8c2e3c8f07" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Here we assume alpha is generated linearly from the time of the strategy issues a signal to the time when the alpha signal is totally exhausted. Like if you have a momentum strategy, it might signal at time T that supply and demand dynamics are indicating the market will rise over the next hour. After that hour the signal is exhausted. If it takes you 20 minutes to scale into the position while minimizing liquidity impact, then you only get to ride the momentum (alpha) from time T + 20 to T + 60, i.e. 40 minutes instead of 60 minutes. We assume that the alpha is generated linearly so the difference from T + 20 to T + 30 is the same as T + 40 to T + 50 etc. Finding alpha is hard enough, so in modelling the exact shape keep it simple.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="33da23a3-f4d4-4996-b564-343c9275c207" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Let‚Äôs look at a diagram of how liquidity impact and alpha loss combine. Notice that going up in this chart means losing more money, and going right means looking at how the price impact evolves over time. Assume you start executing at the left side and as you execute more shares the liquidity impact increases until you‚Äôre done and the price corrects itself. The longer you take, the more alpha loss you will suffer.</div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="65fbcdd3-9b91-4f25-93eb-80db583dc3e4" style="width: 100%; max-width: 1920px; align-self: center; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="height: 100%; width: 100%;"><img referrerpolicy="same-origin" src="assets/images/ac3d8b67e6af75268015094dc8e07b65a05d6f7e.png" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="9588bc61-d0a1-464e-962d-27e6adc7b73d" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">This is a very important diagram. It displays how you can estimate the liquidity impact even though it‚Äôs confounded by the alpha loss. (We‚Äôll need estimates of these two components later) Basically we need to estimate alpha loss first and then liquidity impact second, after subtracting out the effect of alpha loss. For alpha loss, draw the line of best fit on the average of all the stocks that you got signals on but then didn‚Äôt trade. This is like the dashed line in the picture. Then once you have this baseline, draw the line of best fit on all the stocks you did trade and subtract out the baseline. (similarly you could execute a lot of share with no signal to estimate the liquidity first, but it‚Äôs cheaper the other way) Now you have each component.</div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="57dc02ae-4342-42ba-b56d-3da3010f897c" style="width: 100%; max-width: 1728px; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style='max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; font-weight: 600; font-size: 1.875em; line-height: 1.3;'>Execution Shortfall</div></div></div><div class="notion-selectable notion-text-block" data-block-id="a1e4ea2f-c509-4c27-adc5-e67aa69aa762" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">This motivates another definition: Execution Shortfall = Liquidity Impact + Alpha Loss</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="f6566725-2b24-408a-abf2-9a33b19c1f43" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Shortfall is the number we‚Äôll be trying to minimize by choosing a certain time to spread execution over.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="1866befd-cf89-4038-9253-816aa2f2e28a" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Here‚Äôs a diagram of where the minimizing point lies:</div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="30a331bb-20eb-45ca-962d-5f51531caecb" style="width: 100%; max-width: 1920px; align-self: center; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="height: 100%; width: 100%;"><img referrerpolicy="same-origin" src="assets/images/7ccfc4f4eb07bc5746d3d6c7065e49420e1906d3.png" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="a4e0c4ea-71ea-4973-a0dc-13a8143509d8" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Notice that here the x-axis gives different choices of the time you might take to execute, whereas in the previous chart it showed what happened after you chose a certain time and then started to execute. These two curves were estimated in the previous step (but now we say alpha loss is kind of curved because we‚Äôre looking over a longer time range). To find the minimum in Excel or Matlab, add up the two curves and choose the minimum of this sum-curve. For example with numbers along two curves <span class="notion-text-equation-token" contenteditable="false" data-token-index="1" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>10</mn><mo separator="true">,</mo><mn>9</mn><mo separator="true">,</mo><mn>8</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x = (10, 9, 8, 6, 5, 4, 2, 1, 1)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">9</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span><span>Ôªø</span></span>, <span class="notion-text-equation-token" contenteditable="false" data-token-index="3" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>7</mn><mo separator="true">,</mo><mn>8</mn><mo separator="true">,</mo><mn>9</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y = (1, 2, 3, 4, 5, 6, 7, 8, 9)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">9</span><span class="mclose">)</span></span></span></span></span><span>Ôªø</span></span>
to minimize <span class="notion-text-equation-token" contenteditable="false" data-token-index="5" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>+</mo><mi>y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>10</mn><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mn>9</mn><mo>+</mo><mn>2</mn><mo separator="true">,</mo><mn>8</mn><mo>+</mo><mn>3</mn><mo separator="true">,</mo><mn>6</mn><mo>+</mo><mn>4</mn><mo separator="true">,</mo><mn>5</mn><mo>+</mo><mn>5</mn><mo separator="true">,</mo><mn>4</mn><mo>+</mo><mn>6</mn><mo separator="true">,</mo><mn>2</mn><mo>+</mo><mn>7</mn><mo separator="true">,</mo><mn>1</mn><mo>+</mo><mn>8</mn><mo separator="true">,</mo><mn>1</mn><mo>+</mo><mn>9</mn><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>11</mn><mo separator="true">,</mo><mn>11</mn><mo separator="true">,</mo><mn>11</mn><mo separator="true">,</mo><mn>10</mn><mo separator="true">,</mo><mn>10</mn><mo separator="true">,</mo><mn>10</mn><mo separator="true">,</mo><mn>9</mn><mo separator="true">,</mo><mn>9</mn><mo separator="true">,</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x+y = (10+1,9+2,8+3,6+4,5+5,4+6,2+7,1+8,1+9) = (11,11,11,10,10,10,9,9,10)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">10</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">9</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">11</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">11</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">11</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">9</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">9</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">10</span><span class="mclose">)</span></span></span></span></span><span>Ôªø</span></span> we could pick either the 3rd or 2nd to last, which correspond to, say, execution times of <span class="notion-text-equation-token" contenteditable="false" data-token-index="7" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">T = 8</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span></span></span></span></span><span>Ôªø</span></span> or <span class="notion-text-equation-token" contenteditable="false" data-token-index="9" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">T = 9</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">9</span></span></span></span></span><span>Ôªø</span></span>.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="cab1b68f-77e7-4a52-bf37-76a5a4db1773" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">This is what you need to optimize duration of execution. It should be clear that these issues are more important for a large investor than a small one. Also this is a framework that can help to analyse your strategies execution, but of course it‚Äôs not 1-size fits all. For example if you trade around very sudden events then the alpha profile might not be linear. And if you trade in micro caps then liquidity impact could be extremely hard (useless) to model.</div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="7667bbe7-6e30-4d33-9eba-0d2ad878823d" style="width: 100%; max-width: 1728px; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style='max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; font-weight: 600; font-size: 1.875em; line-height: 1.3;'>Capacity</div></div></div><div class="notion-selectable notion-text-block" data-block-id="0cd09eee-efa0-4184-93b5-1afb6cadfba7" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">One final thing to mention, this model is also useful to get a grasp on the capacity of a strategy. Capacity is the amount of money you can manage following a certain strategy before the transaction costs wipe out the alpha. Transaction costs rise when you‚Äôre managing and moving more money. Look at how much transaction costs would have to rise to make there be no optimal execution time. In other words it‚Äôs best never to trade. Based on your transaction cost model, see what this rise corresponds to in terms of number of shares traded and back out the portfolio value that would produce that many orders. There‚Äôs your capacity. Here‚Äôs what it means to be beyond capacity in a simple diagram:</div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="a161f3d8-c4d6-477d-9f15-58e0126534ae" style="width: 100%; max-width: 1920px; align-self: center; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="height: 100%; width: 100%;"><img referrerpolicy="same-origin" src="assets/images/2d1206c7fd18bd906770d26a4d6eb6925602ab97.png" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="8e2bec0c-f728-44ff-bcf0-3e7d4a405153" style="width: 100%; max-width: 1728px; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style='max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; font-weight: 600; font-size: 1.875em; line-height: 1.3;'>Practical Transaction Costs</div></div></div><div class="notion-selectable notion-text-block" data-block-id="1da9c29d-e0d9-4a26-80ab-2ed200e4e6c1" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">It is really good to have a correct intuitive theoretical understanding of systems. However transaction costs are hard to model and usually you just want a rough idea of if a strategy will be profitable. If the details of the transaction costs matter, it is often better to find a model with more edge.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="336bef45-fbc9-4ed9-b260-a359818a9ad8" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Take out a pen and envelope/paper to jot down the numbers and calculations that follow or it will just blur together and you won‚Äôt retain anything.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="64b77184-beb1-4e0a-bc4e-a8ed987d19f1" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Let‚Äôs say you finish a backtest that ignores transaction costs and on average your strategy makes a couple of basis points per trade. Trades are medium-high frequency with a holding period of 15 minutes and a few signals per day. It‚Äôs an equities strategy that works in highly liquid shares like MSFT, with one-to-two penny spreads. Specifically let‚Äôs say it makes on average .00022=2.2bp per trade in MSFT, which was at $26.04 at the time of this analysis. We‚Äôll trade through Interactive Brokers, which has a decent API for automated strategies. Look at the profits and costs on 200-shares.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="9d74c0da-0d48-4489-a3d8-9892d7a8557b" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">The dollar size, 200 shares at $26.04, is $5208. So the dollar alpha per trade is 5208*.00022=1.16$. Conservatively say the spread is $0.02.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="d0c7f737-354c-41c3-958b-9604816225e4" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Here are the choices we have for execution strategies, with their cost per 200 shares, difficulty of programming, and other risks/uncertainty.</div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="f542e5f3-ce13-437a-97ff-ebb26cd7e216" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: unset; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span class="pseudoBefore" style='--pseudoBefore--content:"1."; text-align: center; white-space: nowrap; width: 24px;'></span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">IB bundled, take liquidity. Commission = $0.005/share. total = 0.005*200 = $1. total = $1+spread = 1+.02*200 = $5, easy to code.</div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="ad009be4-4b87-4fa0-bb9e-4c14c7a9939c" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: unset; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span class="pseudoBefore" style='--pseudoBefore--content:"2."; text-align: center; white-space: nowrap; width: 24px;'></span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">Interactive Brokers (IB) bundled, add liquidity. total = commission = $1, harder to code, adverse selection, earn spread.</div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="61e4d00c-ac65-4c69-802f-0e65d32d6474" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: unset; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span class="pseudoBefore" style='--pseudoBefore--content:"3."; text-align: center; white-space: nowrap; width: 24px;'></span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">IB unbundled, Island, add liquidity, peg to midpoint. Commission=.0035/share, Rebate=-.0020/share. total = .0015*200 = $0.3, not too hard to code, probably not much adverse selection nor price improvement.</div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="71224d2b-e4ef-41ee-93a1-78869e2fe460" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: unset; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span class="pseudoBefore" style='--pseudoBefore--content:"4."; text-align: center; white-space: nowrap; width: 24px;'></span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">IB unbundled, BATS, add liquidity. Rebate=.0027. total = .0008*200 = $0.16, harder to code</div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="5b5cd1df-73f8-4aca-93b5-c72c2899f60f" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: unset; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span class="pseudoBefore" style='--pseudoBefore--content:"5."; text-align: center; white-space: nowrap; width: 24px;'></span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">Lime (another broker with a good API), ?. Commission=?. * high volume per month will lower the commissions as low as .001/share.</div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="bd5bb01f-4ec4-4c74-bb92-92f344b30764" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Adverse selection is when you‚Äôre using limit orders and you only get filled on the shares that are moving against you (ie a bid typically gets filled when the price is moving down, so you get a long position as the market drops). Programming liquidity adding strategies takes more work because you have to work orders and eventually cancel and hedge if it never gets filled. This adds a few more steps to the strategy logic.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="895a63f3-e87a-458f-95c2-e4254fa12ca5" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">#3 looks like the best. It‚Äôs low cost and not too hard to program. The uncertain risks mitigate each other. #1 is too expensive. #2 is harder to code and costs more than #3. #4 is harder to code and worse than #3 for a slow trader (ie anyone who‚Äôs not co-located) since BATS doesn‚Äôt have the pegged-to-midpoint order type that Island/INET/NASDAQ has. I don‚Äôt know the details of #5 since they don‚Äôt publish rates, but in the past they were competitive with IB, offered colocation, and had a better API.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="7b863777-f179-4285-a654-8dfd5a500bc5" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">This strategy might seem really bad - you risk $5000 and make $1.16 and pay $0.30.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="bf95815f-a7c8-4d5f-9727-810a6826786f" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">The economics that make automated strategies work are: It trades each of the 100 top liquidity symbols on average 5 times per day on each of the 20 trading days per month and does 400-share position sizes instead of 200. Therefore the total volume is 100*5*20*400=4,000,000. At that level, IB drops commissions from $0.0035/share to $0.0015/share which is less than the rebate, so transaction costs are about $0 (roughly assuming adverse selection slightly outweighs the extra profit from collecting spreads). Profits are 100*5*20*2*$1.16=$23,200/month = $278,400/year.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="0350e27e-82f8-4f82-bec4-078318cbeea4" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">The back-of-the-envelope amount of capital you need: The average holding period is 15 minutes. There are 390 minutes per trading day. We are watching 100 symbols and making on average 5 trades in each per day. So on average we will have 15/390*100*5= 20 positions on at any time. Stocks prices are very correlated and the strategy is based on a price formation though, so to be safe multiply that by 5. 100 positions times $10000 gives the net required capital of $5,000,000. Intraday, it is easy to get 4-20x leverage so the most we‚Äôd probably put up is $1,000,000.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="abf4714c-9ac8-44be-8157-f7879792592e" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Bottom line: 27.8% profits per year is not a huge win but the strategy can probably be improved by filtering. It could be possible to trade more symbols at larger size and get a better commission structure of $0.001/share. Pushing leverage from 5x to 20x, possibly by sitting at a prop shop, boosts returns a lot too.</div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="f8be5250-8374-4094-bcfd-148cf0e536e3" style="width: 100%; max-width: 1728px; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style='max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; font-weight: 600; font-size: 1.875em; line-height: 1.3;'>Extra: Measuring Impact</div></div></div><div class="notion-selectable notion-text-block" data-block-id="6c0f066f-8b3e-4b11-9583-77394ad294c5" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">You can measure the average price impact of a trade of a certain size using public data. Basically you bin all trades by their size and then check the average price change on the next quote.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="851248c7-1fca-4022-85cf-0b36026e7ed6" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">In practice there are more steps:</div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="694b2e5b-e63c-4da7-b7a0-91c260a92456" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: unset; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span class="pseudoBefore" style='--pseudoBefore--content:"1."; text-align: center; white-space: nowrap; width: 24px;'></span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">Load the trade data</div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="f858e1eb-88a3-4d67-8831-c214b066d22b" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: unset; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span class="pseudoBefore" style='--pseudoBefore--content:"2."; text-align: center; white-space: nowrap; width: 24px;'></span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">Aggregate trades with the same timestamp</div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="bdd7f2cf-685e-4151-8595-30c67dbee8ef" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: unset; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span class="pseudoBefore" style='--pseudoBefore--content:"3."; text-align: center; white-space: nowrap; width: 24px;'></span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">Load the quote data</div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="b4e8d4a0-7294-459c-b6ec-639a1e77beb2" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: unset; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span class="pseudoBefore" style='--pseudoBefore--content:"4."; text-align: center; white-space: nowrap; width: 24px;'></span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">Clean the quote data</div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="4094b4aa-a70b-4df4-859f-9ef0c2d8cb38" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: unset; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span class="pseudoBefore" style='--pseudoBefore--content:"5."; text-align: center; white-space: nowrap; width: 24px;'></span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">Classify trades as buys or sells according to the Lee-Ready Rule</div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="da9f724a-d95c-4087-9d48-ab362cf25524" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: unset; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span class="pseudoBefore" style='--pseudoBefore--content:"6."; text-align: center; white-space: nowrap; width: 24px;'></span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">Measure the impact per trade</div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="5d9253a1-9b7a-485d-bdb3-a4bc65b0f19b" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: unset; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span class="pseudoBefore" style='--pseudoBefore--content:"7."; text-align: center; white-space: nowrap; width: 24px;'></span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">Bin trades by size and average following returns</div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="5f636ac2-076a-4acd-b3c3-fd1c9ffc273a" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Then you get nice log-log plots like:</div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="f1cf80d5-039b-441f-902b-d19c22361847" style="width: 100%; max-width: 1920px; align-self: center; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="height: 100%; width: 100%;"><img referrerpolicy="same-origin" src="assets/images/54d9547c60b5204c6cb9af6e03ba0501a9f04ef8.png" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2c3da6e0-a259-4860-a47f-8cf3a75e0e39" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">This says that if you execute an order 0.05 times the average order size, then you will impact the price on average 0.00001. If you execute an order 20 times the average order size, then you will impact the price on average 0.00025. This is in large cap equities where the average spread is 0.01.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="33133216-07d5-4b71-b6bd-79970fb6c884" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Notice that since this is measured as the impact on the very next quote update, it might miss reactions by market makers to pull away after a few microseconds.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="dc055834-fab1-4539-a5d5-d1e93ca46a97" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">This comes from ‚ÄúSingle Curve Collapse of the Price Impact Function for the New York Stock Exchange‚Äù by Lillo, Farmer, and Mantegna.</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2a590ba3-6906-40db-8a11-39f470fdd06b" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Here is R code to replicate it using WRDS‚Äôs TAQ data (see example of trade and quote data above, in simulation). Although this is very specific, I include it because it‚Äôs a good example of a side project you can show an employer that will impress them:</div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="17dc8c86-20d0-4fd7-a9c7-94ac6004e6bd" style="width: 100%; max-width: 1728px; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div contenteditable="false" data-content-editable-void="true" style="flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;"><div><div class="line-numbers notion-code-block" style="display: flex;"><div autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; padding: 34px 16px 32px 32px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre-wrap; word-break: break-all; min-width: 0px;'><span class="token comment" data-token-index="0"># Single Curve Collapse of the Price Impact Function for the New York Stock Exchange</span><span class="" data-token-index="0">
</span><span class="token comment" data-token-index="0"># Fabrizio Lillo, J. Doyne Farmer and Rosario N. Mantegna</span><span class="" data-token-index="0">
</span><span class="token comment" data-token-index="0"># 2002</span><span class="" data-token-index="0">

require</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">xts</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
require</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">Hmisc</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">

path </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token string" data-token-index="0">'your/taq/data/'</span><span class="" data-token-index="0">
csv_mypath </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token keyword" data-token-index="0">function</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">file</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
  read.csv</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">paste</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">path</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">file</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">sep</span><span class="token operator" data-token-index="0">=</span><span class="token string" data-token-index="0">''</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> stringsAsFactors</span><span class="token operator" data-token-index="0">=</span><span class="token boolean" data-token-index="0">FALSE</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
</span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">

</span><span class="token comment" data-token-index="0"># Load GE Trade Data</span><span class="" data-token-index="0">
ge.t </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> csv_mypath</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">'ge_trade_1995.csv'</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
ge.t </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> ge.t</span><span class="token punctuation" data-token-index="0">[</span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0">
ge.t</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">TIME </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> mapply</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">paste</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> as</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge.t</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">DATE</span><span class="token punctuation" data-token-index="0">,</span><span class="token string" data-token-index="0">'character'</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> ge.t</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">TIME</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
ge.t</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">TIME </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> as.POSIXct</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge.t</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">TIME</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">tz</span><span class="token operator" data-token-index="0">=</span><span class="token string" data-token-index="0">'EST'</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">format</span><span class="token operator" data-token-index="0">=</span><span class="token string" data-token-index="0">'%Y%m%d %H:%M:%S'</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
require</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">xts</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
ge.t </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> xts</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge.t</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">c</span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">3</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">4</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">order.by</span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0">ge.t</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">TIME</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
colnames</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge.t</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> c</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">'price'</span><span class="token punctuation" data-token-index="0">,</span><span class="token string" data-token-index="0">'size'</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">

</span><span class="token comment" data-token-index="0"># Aggregate GE trades with the same timestamp</span><span class="" data-token-index="0">
agg </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> coredata</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge.t</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
dates </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> as.integer</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">index</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge.t</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
</span><span class="token keyword" data-token-index="0">for</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">i </span><span class="token keyword" data-token-index="0">in</span><span class="" data-token-index="0"> </span><span class="token number" data-token-index="0">2</span><span class="token operator" data-token-index="0">:</span><span class="" data-token-index="0">dim</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">agg</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
 </span><span class="token keyword" data-token-index="0">if</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">dates</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">]</span><span class="token operator" data-token-index="0">==</span><span class="" data-token-index="0">dates</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
  </span><span class="token keyword" data-token-index="0">if</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">==</span><span class="" data-token-index="0"> agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
   agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">+</span><span class="" data-token-index="0"> agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0">
  </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
  </span><span class="token keyword" data-token-index="0">else</span><span class="" data-token-index="0">
  </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
   agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token operator" data-token-index="0">*</span><span class="" data-token-index="0">agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="token operator" data-token-index="0">+</span><span class="" data-token-index="0">agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token operator" data-token-index="0">*</span><span class="" data-token-index="0">agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="token operator" data-token-index="0">/</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="token operator" data-token-index="0">+</span><span class="" data-token-index="0">agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
   agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">+</span><span class="" data-token-index="0"> agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0">
  </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
  agg</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="" data-token-index="0">
 </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
</span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
ge.t </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> xts</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">agg</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">c</span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">order.by</span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0">index</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge.t</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
ge.t </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> ge.t</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">ge.t</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">size</span><span class="token operator" data-token-index="0">!=</span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0">

</span><span class="token comment" data-token-index="0"># Load GE Quote Data</span><span class="" data-token-index="0">
ge.q </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> rbind</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">csv_mypath</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">'ge_quote_1995_JanJun.csv'</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">
             csv_mypath</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">'ge_quote_1995_JulDec.csv'</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">

ge.q </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> ge.q</span><span class="token punctuation" data-token-index="0">[</span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0">
ge.q</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">TIME </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> mapply</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">paste</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> as</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge.q</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">DATE</span><span class="token punctuation" data-token-index="0">,</span><span class="token string" data-token-index="0">'character'</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> ge.q</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">TIME</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
ge.q</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">TIME </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> as.POSIXct</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge.q</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">TIME</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">tz</span><span class="token operator" data-token-index="0">=</span><span class="token string" data-token-index="0">'EST'</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">format</span><span class="token operator" data-token-index="0">=</span><span class="token string" data-token-index="0">'%Y%m%d %H:%M:%S'</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
ge.q </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> xts</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge.q</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">c</span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">3</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">4</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">order.by</span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0">ge.q</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">TIME</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
colnames</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge.q</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> c</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">‚Äôbid‚Äô</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">‚Äôofr‚Äô</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">

</span><span class="token comment" data-token-index="0"># Clean GE Quote Data</span><span class="" data-token-index="0">
ge.q </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> ge.q</span><span class="token punctuation" data-token-index="0">[</span><span class="token operator" data-token-index="0">!</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge.q</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">bid</span><span class="token operator" data-token-index="0">==</span><span class="token number" data-token-index="0">0</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">|</span><span class="" data-token-index="0"> ge.q</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">ofr</span><span class="token operator" data-token-index="0">==</span><span class="token number" data-token-index="0">0</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># Bid/Offer of 0 is a data error</span><span class="" data-token-index="0">

ge </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> merge</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge.t</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> ge.q</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
</span><span class="token comment" data-token-index="0"># Final Result: variable ‚Äôge‚Äô is an xts with NA‚Äôs showing trades / quotes</span><span class="" data-token-index="0">

</span><span class="token comment" data-token-index="0">#ge.t = NULL</span><span class="" data-token-index="0">
</span><span class="token comment" data-token-index="0">#ge.q = NULL</span><span class="" data-token-index="0">

</span><span class="token comment" data-token-index="0"># Classify the direction of trades according to Lee-Ready (1991)</span><span class="" data-token-index="0">
ge</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">mid    </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">bid</span><span class="token operator" data-token-index="0">+</span><span class="" data-token-index="0">ge</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">ofr</span><span class="token punctuation" data-token-index="0">)</span><span class="token operator" data-token-index="0">/</span><span class="token number" data-token-index="0">2</span><span class="" data-token-index="0">
ge</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">dir    </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> matrix</span><span class="token punctuation" data-token-index="0">(</span><span class="token keyword" data-token-index="0">NA</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">dim</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
d </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> coredata</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># data.frame(coredata(ge)) is insanely slower</span><span class="" data-token-index="0">
p1 </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> d</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0">
d</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">6</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token number" data-token-index="0">1</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># Assume the first trade was up</span><span class="" data-token-index="0">
dir1 </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> d</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">6</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0">
q1 </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> d</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">5</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0">
</span><span class="token keyword" data-token-index="0">for</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">i </span><span class="token keyword" data-token-index="0">in</span><span class="" data-token-index="0"> </span><span class="token number" data-token-index="0">3</span><span class="token operator" data-token-index="0">:</span><span class="" data-token-index="0">dim</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">d</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
</span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
 p2 </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> d</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># current price</span><span class="" data-token-index="0">
 </span><span class="token keyword" data-token-index="0">if</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="token operator" data-token-index="0">!</span><span class="" data-token-index="0">is.na</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">p2</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># Trade</span><span class="" data-token-index="0">
 </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
  </span><span class="token comment" data-token-index="0"># Quote Rule</span><span class="" data-token-index="0">
  </span><span class="token keyword" data-token-index="0">if</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">p2 </span><span class="token operator" data-token-index="0">&gt;</span><span class="" data-token-index="0"> q1</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
  </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
   d</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">6</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token number" data-token-index="0">1</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># Direction</span><span class="" data-token-index="0">
  </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
  </span><span class="token keyword" data-token-index="0">else</span><span class="" data-token-index="0"> </span><span class="token keyword" data-token-index="0">if</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">p2 </span><span class="token operator" data-token-index="0">&lt;</span><span class="" data-token-index="0"> q1</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
  </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
   d</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">6</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="" data-token-index="0">
  </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
  </span><span class="token keyword" data-token-index="0">else</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># p == midpoint</span><span class="" data-token-index="0">
  </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
   </span><span class="token comment" data-token-index="0"># Tick Rule</span><span class="" data-token-index="0">
   </span><span class="token keyword" data-token-index="0">if</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">p2 </span><span class="token operator" data-token-index="0">&gt;</span><span class="" data-token-index="0"> p1</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
   </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
    d</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">6</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token number" data-token-index="0">1</span><span class="" data-token-index="0">
   </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
   </span><span class="token keyword" data-token-index="0">if</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">p2 </span><span class="token operator" data-token-index="0">&lt;</span><span class="" data-token-index="0"> p1</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
   </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
    d</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">6</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="" data-token-index="0">
   </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
   </span><span class="token keyword" data-token-index="0">else</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># prices stayed the same</span><span class="" data-token-index="0">
   </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
    d</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">6</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> dir1
   </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
  </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
  p1 </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> p2
  dir1 </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> d</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">6</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0">
 </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
 </span><span class="token keyword" data-token-index="0">else</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># Quote</span><span class="" data-token-index="0">
 </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
  q1 </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> d</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">5</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># Update most recent midpoint</span><span class="" data-token-index="0">
 </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
</span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">

</span><span class="token comment" data-token-index="0"># Measure impact per trade</span><span class="" data-token-index="0">
d2 </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> cbind</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">d</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">6</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">d</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">log</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">d</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">5</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">matrix</span><span class="token punctuation" data-token-index="0">(</span><span class="token keyword" data-token-index="0">NA</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">dim</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">d</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
colnames</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">d2</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> c</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">‚Äôdir‚Äô</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">‚Äôsize‚Äô</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">‚Äôlogmid‚Äô</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">‚Äôimpact‚Äô</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
trade_i1 </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token number" data-token-index="0">1</span><span class="" data-token-index="0">
quote_i1 </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token number" data-token-index="0">2</span><span class="" data-token-index="0">
</span><span class="token keyword" data-token-index="0">for</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">i2 </span><span class="token keyword" data-token-index="0">in</span><span class="" data-token-index="0"> </span><span class="token number" data-token-index="0">3</span><span class="token operator" data-token-index="0">:</span><span class="" data-token-index="0">dim</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">d2</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
</span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
 dir_i2 </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> d2</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i2</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0">
 </span><span class="token keyword" data-token-index="0">if</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="token operator" data-token-index="0">!</span><span class="" data-token-index="0">is.na</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">dir_i2</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># Trade</span><span class="" data-token-index="0">
 </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
  </span><span class="token keyword" data-token-index="0">if</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">i2</span><span class="token operator" data-token-index="0">-</span><span class="" data-token-index="0">trade_i1 </span><span class="token operator" data-token-index="0">==</span><span class="" data-token-index="0"> </span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># Following another a trade</span><span class="" data-token-index="0">
  </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
   d2</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">trade_i1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">4</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token number" data-token-index="0">0</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># \delta p = 0</span><span class="" data-token-index="0">
  </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
  trade_i1 </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> i2
 </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
 </span><span class="token keyword" data-token-index="0">else</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># Quote</span><span class="" data-token-index="0">
 </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
  </span><span class="token keyword" data-token-index="0">if</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">i2</span><span class="token operator" data-token-index="0">-</span><span class="" data-token-index="0">trade_i1 </span><span class="token operator" data-token-index="0">==</span><span class="" data-token-index="0"> </span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># Following a trade</span><span class="" data-token-index="0">
  </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">
   d2</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">trade_i1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">4</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> d2</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">i2</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">3</span><span class="token punctuation" data-token-index="0">]</span><span class="token operator" data-token-index="0">-</span><span class="" data-token-index="0">d2</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">quote_i1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">3</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># diff(logmids)</span><span class="" data-token-index="0">
  </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
  quote_i1 </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> i2
 </span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
</span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">

</span><span class="token comment" data-token-index="0"># Look only at buyer initiated trades</span><span class="" data-token-index="0">
buy </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> d2</span><span class="token punctuation" data-token-index="0">[</span><span class="token operator" data-token-index="0">!</span><span class="" data-token-index="0">is.na</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">d2</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">4</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">&amp;</span><span class="" data-token-index="0"> d2</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token operator" data-token-index="0">==</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0">
buy </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> buy</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">c</span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">4</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0">
buy</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> buy</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token operator" data-token-index="0">/</span><span class="" data-token-index="0">mean</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">buy</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
require</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">Hmisc</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
max_bins </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token number" data-token-index="0">50</span><span class="" data-token-index="0">
sizes </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> as.double</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">levels</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">cut2</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">buy</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">g</span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0">max_bins</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">levels.mean</span><span class="token operator" data-token-index="0">=</span><span class="token boolean" data-token-index="0">TRUE</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
buy</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> cut2</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">buy</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">g</span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0">max_bins</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">levels.mean</span><span class="token operator" data-token-index="0">=</span><span class="token boolean" data-token-index="0">TRUE</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
ge_imp </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> aggregate</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">buy</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> list</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">buy</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> mean</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
plot</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">sizes</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">ge_imp</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">log</span><span class="token operator" data-token-index="0">=</span><span class="token string" data-token-index="0">'xy'</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">type</span><span class="token operator" data-token-index="0">=</span><span class="token string" data-token-index="0">'o'</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">pch</span><span class="token operator" data-token-index="0">=</span><span class="token number" data-token-index="0">15</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">ylab</span><span class="token operator" data-token-index="0">=</span><span class="token string" data-token-index="0">'price shift'</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">
     xlab</span><span class="token operator" data-token-index="0">=</span><span class="token string" data-token-index="0">'normalized volume'</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">main</span><span class="token operator" data-token-index="0">=</span><span class="token string" data-token-index="0">'GE'</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">

</span><span class="token comment" data-token-index="0"># Find how the price impact increases with volume</span><span class="" data-token-index="0">
imp_fit </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token keyword" data-token-index="0">function</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">pow</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">summary</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">lm</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">ge_imp</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">~</span><span class="" data-token-index="0"> I</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">sizes</span><span class="token operator" data-token-index="0">^</span><span class="" data-token-index="0">pow</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="token operator" data-token-index="0">$</span><span class="" data-token-index="0">r.squared</span><span class="token punctuation" data-token-index="0">}</span><span class="" data-token-index="0">
fits </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> sapply</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">seq</span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">0</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">.01</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> imp_fit</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
print</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">paste</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">'R^2 minimizing beta in volume^beta=impact:'</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">which.max</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">fits</span><span class="token punctuation" data-token-index="0">)</span><span class="token operator" data-token-index="0">/</span><span class="token number" data-token-index="0">100</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
print</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">'Difference is likely because of Lee-Ready flat trade/quote ambiguity'</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
print</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">'and timestamp aggregation ambiguity.'</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
print</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">'A huge number of trades were labeled as having 0 impact.'</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
</span><span>
</span></div></div></div><div style="position: absolute; top: 3px; right: 1px; color: rgba(55, 53, 47, 0.65); display: flex; align-items: center; justify-content: flex-end; height: 25px; font-size: 11.5px; opacity: 0; transition: opacity 300ms ease-in 0s;"></div><div style="position: absolute; top: 8px; left: 8px; color: rgba(55, 53, 47, 0.65); display: flex; align-items: center; justify-content: flex-end; opacity: 0; transition: opacity 300ms ease-in 0s;"><div aria-disabled="true" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.65); margin-right: 5px;" tabindex="-1">R<svg class="chevronDown" style="width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.35); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;" viewBox="0 0 30 30"><polygon points="15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "></polygon></svg></div></div><div style="background: white; padding-right: 105px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="ec0b66e6-1981-440d-b35a-cc5a1b5f36d2" style="width: 100%; max-width: 1728px; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; min-height: 1em; color: rgb(55, 53, 47); -webkit-text-fill-color: rgba(55, 53, 47, 0.5);"></div></div></div></div></div></div><div contenteditable="false" data-content-editable-void="true" style="width: 0px;"><div style="display: none; flex-shrink: 0; pointer-events: none; width: 0px; position: absolute; right: 192px; opacity: 0;"><div style="display: flex; flex-direction: column; padding: 5px 16px; width: 340px; flex-shrink: 0; height: 100%; position: relative; pointer-events: none; z-index: 1;"><div style="position: absolute; pointer-events: none; width: 100%; height: 100%; top: -5px; background: linear-gradient(white 0px, rgba(255, 255, 255, 0) 15px);"></div></div></div></div></main><span style="height: 1px; width: 1px;"></span></div><div class="notion-presence-container" style="position: absolute; top: 0px; left: 0px; z-index: 89;"><div></div></div></div></div></div><div class="notion-peek-renderer" style="position: fixed; top: 0px; right: 0px; bottom: 0px; width: 960px; z-index: 109; transform: translateX(960px) translateZ(0px);"></div></div></div></div></div><textarea aria-hidden="true" style="opacity: 0; pointer-events: none; position: fixed; left: 0px; top: 0px;" tabindex="-1"></textarea><textarea aria-hidden="true" style="opacity: 0; pointer-events: none; position: fixed; left: 0px; top: 0px;" tabindex="-1"></textarea><script src="assets/js/1172e9111a5fb396bcb8a05870b5eabf8abf221c.js" type="text/javascript"></script><div style="width: env(safe-area-inset-bottom);"></div></body></html>